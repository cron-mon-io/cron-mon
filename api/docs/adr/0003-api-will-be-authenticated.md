# 3. The API will be authenticated

Date: 2024-08-06

## Status

Accepted



## Context

CronMon's API allows users to setup and manage monitors for their cronjobs and scheduled tasks.
These monitors and the recorded jobs within them could contain sensitive information, so viewing
this data needs to be restricted to only users that have been authenticated and are authorised to
viewed them. Similarly, creating, modifying and deleted monitors also needs to be restricted to only
authenticated users, as CronMon is ultimately an observability tool, and allowing any user to delete
a monitor could result in alerts and notifications when a job fails not being sent to whoever it
needs to be sent to.

## Decision

The API's endpoints that CRUD Monitors will be protected by JWTs. These JWTs will be generated by
[Keycloak](https://www.keycloak.org/), obtained by
[the frontend application](https://github.com/cron-mon-io/cron-mon-app) via OIDC. These JWTs will
only be valid for 20 minutes before needing to be refreshed by the frontend application. As a
result, the endpoints that start and finish jobs _won't_ be protected by JWTs, instead they will be
protected by API keys, which will be managed by CRUD endpoints that are again, proteceted by JWT
authentication.

## Consequences

Using the API in isolation will be more difficult from a developer experience perspective, as a JWT
will need to be obtained somehow, and will need to be re-obtained 20 minutes later. This should be
a very minor issue since the frontend app will most likely be used alongside the backend service
for the vast majority of use-cases.
